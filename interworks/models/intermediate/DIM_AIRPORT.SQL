{{ config(materialized='table') }}

SELECT DISTINCT
    ORIGINAIRPORTCODE,
    TRIM(SPLIT_PART("ORIGAIRPORTNAME", ':', 2)) AS "ORIGAIRPORTNAME", -- Removing concatenated city and state
    ORIGINCITYNAME,
    ORIGINSTATE,
    ORIGINSTATENAME,
    'ORIGIN' AS AIRPORT_TYPE,
    NULL AS DESTAIRPORTCODE,
    NULL AS "DESTAIRPORTNAME", -- Removing concatenated city and state
    NULL AS DESTCITYNAME,
    NULL AS DESTSTATE,
    NULL AS DESTSTATENAME
FROM {{ ref('STG_FLIGHTS') }}

UNION ALL

SELECT DISTINCT
    NULL AS ORIGINAIRPORTCODE,
    NULL AS "ORIGAIRPORTNAME", -- Removing concatenated city and state
    NULL AS ORIGINCITYNAME,
    NULL AS ORIGINSTATE,
    NULL AS ORIGINSTATENAME,
    'DESTINATION' AS AIRPORT_TYPE,
    DESTAIRPORTCODE,
    TRIM(SPLIT_PART("DESTAIRPORTNAME", ':', 2)) AS "DESTAIRPORTNAME", -- Removing concatenated city and state
    DESTCITYNAME,
    DESTSTATE,
    DESTSTATENAME
FROM {{ ref('STG_FLIGHTS') }}